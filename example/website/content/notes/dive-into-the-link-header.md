+++
title = "A dive into the  Link header"
description = "This note describes my current understanding of the  Link header as defined\nby the [IETF RFC8288]."
date = 2019-06-22
template = "note.html"
in_search_index = true

[extra]
id = "dive-into-the-link-header"
title = "A dive into the `Link` header"
summary = "This note describes my current understanding of the `Link` header as defined\nby the [IETF RFC8288]."

[extra.author]
id = "arnau"
name = "Arnau Siches"
guest = false
+++

## The link model

In words of the RFC8288, “ ...] a link is a typed connection between two resources ...] ”.

The RFC defines the following concepts:

- Link **context** : The subject of the connection.
- Link **target** : The object of the connection.
- Link **relation type** : The type of connection.
- Target **attributes** : A set of optional target descriptors.
- Target **attribute extension** : Set of attributes not defined by the RFC. 
For example, given a resource `A`, the context, linked to a resource `B`, the target, with a relation type `alternate` it can be depicted as:


<div class="figure from-dot">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.48.0 (20210717.1556)
 -->
<!-- Title: g Pages: 1 -->
<svg width="208pt" height="44pt"
 viewBox="0.00 0.00 207.97 44.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 40)">
<title>g</title>
<polygon fill="transparent" stroke="transparent" points="-4,4 -4,-40 203.97,-40 203.97,4 -4,4"/>
<!-- A -->
<g id="node1" class="node">
<title>A</title>
<polygon fill="none" stroke="black" points="31.43,-0.05 33.2,-0.15 34.96,-0.3 36.69,-0.49 38.39,-0.74 40.05,-1.03 41.67,-1.36 43.23,-1.75 44.73,-2.18 46.17,-2.65 47.54,-3.16 48.84,-3.71 50.06,-4.31 51.2,-4.94 52.25,-5.61 53.22,-6.31 54.09,-7.04 54.87,-7.8 55.56,-8.59 56.15,-9.41 56.65,-10.25 57.05,-11.11 57.36,-11.99 57.58,-12.89 57.7,-13.8 57.73,-14.72 57.68,-15.65 57.54,-16.59 57.31,-17.53 57.01,-18.47 56.63,-19.41 56.18,-20.35 55.66,-21.28 55.08,-22.2 54.43,-23.11 53.72,-24.01 52.97,-24.89 52.16,-25.75 51.3,-26.59 50.41,-27.41 49.48,-28.2 48.51,-28.96 47.51,-29.69 46.48,-30.39 45.43,-31.06 44.35,-31.69 43.26,-32.29 42.15,-32.84 41.02,-33.35 39.89,-33.82 38.74,-34.25 37.58,-34.64 36.42,-34.97 35.24,-35.26 34.07,-35.51 32.89,-35.7 31.71,-35.85 30.52,-35.95 29.34,-36 28.15,-36 26.96,-35.95 25.78,-35.85 24.6,-35.7 23.42,-35.51 22.24,-35.26 21.07,-34.97 19.91,-34.64 18.75,-34.25 17.6,-33.82 16.46,-33.35 15.34,-32.84 14.23,-32.29 13.13,-31.69 12.06,-31.06 11.01,-30.39 9.98,-29.69 8.98,-28.96 8.01,-28.2 7.08,-27.41 6.18,-26.59 5.33,-25.75 4.52,-24.89 3.76,-24.01 3.06,-23.11 2.41,-22.2 1.83,-21.28 1.3,-20.35 0.85,-19.41 0.47,-18.47 0.17,-17.53 -0.05,-16.59 -0.19,-15.65 -0.25,-14.72 -0.21,-13.8 -0.09,-12.89 0.13,-11.99 0.43,-11.11 0.84,-10.25 1.34,-9.41 1.93,-8.59 2.62,-7.8 3.4,-7.04 4.27,-6.31 5.24,-5.61 6.29,-4.94 7.43,-4.31 8.65,-3.71 9.94,-3.16 11.31,-2.65 12.75,-2.18 14.26,-1.75 15.82,-1.36 17.44,-1.03 19.1,-0.74 20.79,-0.49 22.53,-0.3 24.28,-0.15 26.06,-0.05 27.85,0 29.64,0 31.43,-0.05"/>
<text text-anchor="middle" x="28.74" y="-14.3" font-family="Times,serif" font-size="14.00">A</text>
</g>
<!-- B -->
<g id="node2" class="node">
<title>B</title>
<polygon fill="none" stroke="black" points="173.91,-0.05 175.69,-0.15 177.45,-0.3 179.18,-0.49 180.88,-0.74 182.54,-1.03 184.15,-1.36 185.71,-1.75 187.22,-2.18 188.66,-2.65 190.03,-3.16 191.33,-3.71 192.55,-4.31 193.69,-4.94 194.74,-5.61 195.7,-6.31 196.58,-7.04 197.36,-7.8 198.04,-8.59 198.64,-9.41 199.14,-10.25 199.54,-11.11 199.85,-11.99 200.06,-12.89 200.19,-13.8 200.22,-14.72 200.16,-15.65 200.02,-16.59 199.8,-17.53 199.5,-18.47 199.12,-19.41 198.67,-20.35 198.15,-21.28 197.56,-22.2 196.92,-23.11 196.21,-24.01 195.45,-24.89 194.65,-25.75 193.79,-26.59 192.9,-27.41 191.96,-28.2 190.99,-28.96 189.99,-29.69 188.97,-30.39 187.91,-31.06 186.84,-31.69 185.75,-32.29 184.64,-32.84 183.51,-33.35 182.37,-33.82 181.22,-34.25 180.07,-34.64 178.9,-34.97 177.73,-35.26 176.56,-35.51 175.38,-35.7 174.19,-35.85 173.01,-35.95 171.82,-36 170.64,-36 169.45,-35.95 168.27,-35.85 167.08,-35.7 165.91,-35.51 164.73,-35.26 163.56,-34.97 162.39,-34.64 161.24,-34.25 160.09,-33.82 158.95,-33.35 157.82,-32.84 156.71,-32.29 155.62,-31.69 154.55,-31.06 153.49,-30.39 152.47,-29.69 151.47,-28.96 150.5,-28.2 149.56,-27.41 148.67,-26.59 147.82,-25.75 147.01,-24.89 146.25,-24.01 145.55,-23.11 144.9,-22.2 144.31,-21.28 143.79,-20.35 143.34,-19.41 142.96,-18.47 142.66,-17.53 142.44,-16.59 142.3,-15.65 142.24,-14.72 142.27,-13.8 142.4,-12.89 142.61,-11.99 142.92,-11.11 143.32,-10.25 143.82,-9.41 144.42,-8.59 145.1,-7.8 145.88,-7.04 146.76,-6.31 147.72,-5.61 148.78,-4.94 149.91,-4.31 151.13,-3.71 152.43,-3.16 153.8,-2.65 155.24,-2.18 156.75,-1.75 158.31,-1.36 159.92,-1.03 161.58,-0.74 163.28,-0.49 165.01,-0.3 166.77,-0.15 168.55,-0.05 170.33,0 172.13,0 173.91,-0.05"/>
<text text-anchor="middle" x="171.23" y="-14.3" font-family="Times,serif" font-size="14.00">B</text>
</g>
<!-- A&#45;&gt;B -->
<g id="edge1" class="edge">
<title>A&#45;&gt;B</title>
<path fill="none" stroke="black" d="M57.16,-18C78.59,-18 108.61,-18 132.33,-18"/>
<polygon fill="black" stroke="black" points="132.4,-21.5 142.4,-18 132.4,-14.5 132.4,-21.5"/>
<text text-anchor="middle" x="99.99" y="-21.8" font-family="Times,serif" font-size="14.00">alternate</text>
</g>
</g>
</svg>
</div>

Building on that, let's define that `B`, the target, has a content type [[IETF RFC2046](https://tools.ietf.org/html/rfc2046)] of `text/csv` :


<div class="figure from-dot">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.48.0 (20210717.1556)
 -->
<!-- Title: g Pages: 1 -->
<svg width="329pt" height="44pt"
 viewBox="0.00 0.00 328.97 44.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 40)">
<title>g</title>
<polygon fill="transparent" stroke="transparent" points="-4,4 -4,-40 324.97,-40 324.97,4 -4,4"/>
<!-- A -->
<g id="node1" class="node">
<title>A</title>
<polygon fill="none" stroke="black" points="31.43,-0.05 33.2,-0.15 34.96,-0.3 36.69,-0.49 38.39,-0.74 40.05,-1.03 41.67,-1.36 43.23,-1.75 44.73,-2.18 46.17,-2.65 47.54,-3.16 48.84,-3.71 50.06,-4.31 51.2,-4.94 52.25,-5.61 53.22,-6.31 54.09,-7.04 54.87,-7.8 55.56,-8.59 56.15,-9.41 56.65,-10.25 57.05,-11.11 57.36,-11.99 57.58,-12.89 57.7,-13.8 57.73,-14.72 57.68,-15.65 57.54,-16.59 57.31,-17.53 57.01,-18.47 56.63,-19.41 56.18,-20.35 55.66,-21.28 55.08,-22.2 54.43,-23.11 53.72,-24.01 52.97,-24.89 52.16,-25.75 51.3,-26.59 50.41,-27.41 49.48,-28.2 48.51,-28.96 47.51,-29.69 46.48,-30.39 45.43,-31.06 44.35,-31.69 43.26,-32.29 42.15,-32.84 41.02,-33.35 39.89,-33.82 38.74,-34.25 37.58,-34.64 36.42,-34.97 35.24,-35.26 34.07,-35.51 32.89,-35.7 31.71,-35.85 30.52,-35.95 29.34,-36 28.15,-36 26.96,-35.95 25.78,-35.85 24.6,-35.7 23.42,-35.51 22.24,-35.26 21.07,-34.97 19.91,-34.64 18.75,-34.25 17.6,-33.82 16.46,-33.35 15.34,-32.84 14.23,-32.29 13.13,-31.69 12.06,-31.06 11.01,-30.39 9.98,-29.69 8.98,-28.96 8.01,-28.2 7.08,-27.41 6.18,-26.59 5.33,-25.75 4.52,-24.89 3.76,-24.01 3.06,-23.11 2.41,-22.2 1.83,-21.28 1.3,-20.35 0.85,-19.41 0.47,-18.47 0.17,-17.53 -0.05,-16.59 -0.19,-15.65 -0.25,-14.72 -0.21,-13.8 -0.09,-12.89 0.13,-11.99 0.43,-11.11 0.84,-10.25 1.34,-9.41 1.93,-8.59 2.62,-7.8 3.4,-7.04 4.27,-6.31 5.24,-5.61 6.29,-4.94 7.43,-4.31 8.65,-3.71 9.94,-3.16 11.31,-2.65 12.75,-2.18 14.26,-1.75 15.82,-1.36 17.44,-1.03 19.1,-0.74 20.79,-0.49 22.53,-0.3 24.28,-0.15 26.06,-0.05 27.85,0 29.64,0 31.43,-0.05"/>
<text text-anchor="middle" x="28.74" y="-14.3" font-family="Times,serif" font-size="14.00">A</text>
</g>
<!-- B -->
<g id="node2" class="node">
<title>B</title>
<polygon fill="none" stroke="black" points="173.91,-0.05 175.69,-0.15 177.45,-0.3 179.18,-0.49 180.88,-0.74 182.54,-1.03 184.15,-1.36 185.71,-1.75 187.22,-2.18 188.66,-2.65 190.03,-3.16 191.33,-3.71 192.55,-4.31 193.69,-4.94 194.74,-5.61 195.7,-6.31 196.58,-7.04 197.36,-7.8 198.04,-8.59 198.64,-9.41 199.14,-10.25 199.54,-11.11 199.85,-11.99 200.06,-12.89 200.19,-13.8 200.22,-14.72 200.16,-15.65 200.02,-16.59 199.8,-17.53 199.5,-18.47 199.12,-19.41 198.67,-20.35 198.15,-21.28 197.56,-22.2 196.92,-23.11 196.21,-24.01 195.45,-24.89 194.65,-25.75 193.79,-26.59 192.9,-27.41 191.96,-28.2 190.99,-28.96 189.99,-29.69 188.97,-30.39 187.91,-31.06 186.84,-31.69 185.75,-32.29 184.64,-32.84 183.51,-33.35 182.37,-33.82 181.22,-34.25 180.07,-34.64 178.9,-34.97 177.73,-35.26 176.56,-35.51 175.38,-35.7 174.19,-35.85 173.01,-35.95 171.82,-36 170.64,-36 169.45,-35.95 168.27,-35.85 167.08,-35.7 165.91,-35.51 164.73,-35.26 163.56,-34.97 162.39,-34.64 161.24,-34.25 160.09,-33.82 158.95,-33.35 157.82,-32.84 156.71,-32.29 155.62,-31.69 154.55,-31.06 153.49,-30.39 152.47,-29.69 151.47,-28.96 150.5,-28.2 149.56,-27.41 148.67,-26.59 147.82,-25.75 147.01,-24.89 146.25,-24.01 145.55,-23.11 144.9,-22.2 144.31,-21.28 143.79,-20.35 143.34,-19.41 142.96,-18.47 142.66,-17.53 142.44,-16.59 142.3,-15.65 142.24,-14.72 142.27,-13.8 142.4,-12.89 142.61,-11.99 142.92,-11.11 143.32,-10.25 143.82,-9.41 144.42,-8.59 145.1,-7.8 145.88,-7.04 146.76,-6.31 147.72,-5.61 148.78,-4.94 149.91,-4.31 151.13,-3.71 152.43,-3.16 153.8,-2.65 155.24,-2.18 156.75,-1.75 158.31,-1.36 159.92,-1.03 161.58,-0.74 163.28,-0.49 165.01,-0.3 166.77,-0.15 168.55,-0.05 170.33,0 172.13,0 173.91,-0.05"/>
<text text-anchor="middle" x="171.23" y="-14.3" font-family="Times,serif" font-size="14.00">B</text>
</g>
<!-- A&#45;&gt;B -->
<g id="edge1" class="edge">
<title>A&#45;&gt;B</title>
<path fill="none" stroke="black" d="M57.16,-18C78.59,-18 108.61,-18 132.33,-18"/>
<polygon fill="black" stroke="black" points="132.4,-21.5 142.4,-18 132.4,-14.5 132.4,-21.5"/>
<text text-anchor="middle" x="99.99" y="-21.8" font-family="Times,serif" font-size="14.00">alternate</text>
</g>
<!-- text/csv -->
<g id="node3" class="node">
<title>text/csv</title>
<polygon fill="none" stroke="black" points="320.97,-36 260.97,-36 260.97,0 320.97,0 320.97,-36"/>
<text text-anchor="middle" x="290.97" y="-14.3" font-family="Times,serif" font-size="14.00">text/csv</text>
</g>
<!-- B&#45;&gt;text/csv -->
<g id="edge2" class="edge">
<title>B&#45;&gt;text/csv</title>
<path fill="none" stroke="black" d="M199.84,-18C215.03,-18 234.15,-18 250.86,-18"/>
<polygon fill="black" stroke="black" points="250.9,-21.5 260.9,-18 250.9,-14.5 250.9,-21.5"/>
<text text-anchor="middle" x="230.47" y="-21.8" font-family="Times,serif" font-size="14.00">type</text>
</g>
</g>
</svg>
</div>

Given that we are in HTTP territory, resources are identified by URLs. The previous example, using URLs could be something like:


<div class="figure from-dot">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.48.0 (20210717.1556)
 -->
<!-- Title: g Pages: 1 -->
<svg width="252pt" height="218pt"
 viewBox="0.00 0.00 251.64 218.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 214)">
<title>g</title>
<polygon fill="transparent" stroke="transparent" points="-4,4 -4,-214 247.64,-214 247.64,4 -4,4"/>
<!-- A -->
<g id="node1" class="node">
<title>A</title>
<polygon fill="none" stroke="black" points="133.07,-174.05 140.53,-174.15 147.9,-174.3 155.17,-174.49 162.3,-174.74 169.27,-175.03 176.04,-175.36 182.59,-175.75 188.91,-176.18 194.95,-176.65 200.7,-177.16 206.15,-177.71 211.26,-178.31 216.04,-178.94 220.45,-179.61 224.5,-180.31 228.17,-181.04 231.45,-181.8 234.33,-182.59 236.82,-183.41 238.91,-184.25 240.6,-185.11 241.89,-185.99 242.8,-186.89 243.31,-187.8 243.45,-188.72 243.22,-189.65 242.64,-190.59 241.7,-191.53 240.43,-192.47 238.84,-193.41 236.95,-194.35 234.77,-195.28 232.31,-196.2 229.59,-197.11 226.64,-198.01 223.45,-198.89 220.07,-199.75 216.48,-200.59 212.73,-201.41 208.81,-202.2 204.75,-202.96 200.55,-203.69 196.24,-204.39 191.82,-205.06 187.32,-205.69 182.73,-206.29 178.07,-206.84 173.34,-207.35 168.57,-207.82 163.75,-208.25 158.9,-208.64 154.01,-208.97 149.1,-209.26 144.16,-209.51 139.21,-209.7 134.25,-209.85 129.28,-209.95 124.31,-210 119.33,-210 114.36,-209.95 109.39,-209.85 104.42,-209.7 99.47,-209.51 94.54,-209.26 89.63,-208.97 84.74,-208.64 79.88,-208.25 75.07,-207.82 70.29,-207.35 65.57,-206.84 60.91,-206.29 56.32,-205.69 51.81,-205.06 47.4,-204.39 43.08,-203.69 38.89,-202.96 34.83,-202.2 30.91,-201.41 27.15,-200.59 23.57,-199.75 20.18,-198.89 17,-198.01 14.04,-197.11 11.33,-196.2 8.87,-195.28 6.69,-194.35 4.79,-193.41 3.2,-192.47 1.94,-191.53 1,-190.59 0.41,-189.65 0.18,-188.72 0.32,-187.8 0.84,-186.89 1.74,-185.99 3.04,-185.11 4.73,-184.25 6.82,-183.41 9.31,-182.59 12.19,-181.8 15.47,-181.04 19.14,-180.31 23.18,-179.61 27.6,-178.94 32.37,-178.31 37.49,-177.71 42.93,-177.16 48.69,-176.65 54.73,-176.18 61.04,-175.75 67.6,-175.36 74.37,-175.03 81.34,-174.74 88.47,-174.49 95.73,-174.3 103.11,-174.15 110.56,-174.05 118.06,-174 125.58,-174 133.07,-174.05"/>
<text text-anchor="middle" x="121.82" y="-188.3" font-family="Times,serif" font-size="14.00">https://example.org/foo.html</text>
</g>
<!-- B -->
<g id="node2" class="node">
<title>B</title>
<polygon fill="none" stroke="black" points="132.64,-87.05 139.8,-87.15 146.9,-87.3 153.88,-87.49 160.74,-87.74 167.44,-88.03 173.95,-88.36 180.25,-88.75 186.32,-89.18 192.13,-89.65 197.66,-90.16 202.89,-90.71 207.81,-91.31 212.4,-91.94 216.65,-92.61 220.54,-93.31 224.07,-94.04 227.22,-94.8 229.99,-95.59 232.38,-96.41 234.39,-97.25 236.02,-98.11 237.26,-98.99 238.13,-99.89 238.63,-100.8 238.76,-101.72 238.54,-102.65 237.98,-103.59 237.08,-104.53 235.86,-105.47 234.33,-106.41 232.51,-107.35 230.41,-108.28 228.05,-109.2 225.44,-110.11 222.59,-111.01 219.54,-111.89 216.28,-112.75 212.83,-113.59 209.22,-114.41 205.46,-115.2 201.55,-115.96 197.52,-116.69 193.37,-117.39 189.13,-118.06 184.79,-118.69 180.38,-119.29 175.9,-119.84 171.36,-120.35 166.77,-120.82 162.13,-121.25 157.47,-121.64 152.77,-121.97 148.04,-122.26 143.3,-122.51 138.54,-122.7 133.77,-122.85 128.99,-122.95 124.21,-123 119.43,-123 114.64,-122.95 109.86,-122.85 105.09,-122.7 100.34,-122.51 95.59,-122.26 90.87,-121.97 86.17,-121.64 81.5,-121.25 76.87,-120.82 72.28,-120.35 67.74,-119.84 63.26,-119.29 58.85,-118.69 54.51,-118.06 50.26,-117.39 46.12,-116.69 42.09,-115.96 38.18,-115.2 34.41,-114.41 30.8,-113.59 27.36,-112.75 24.1,-111.89 21.04,-111.01 18.2,-110.11 15.59,-109.2 13.23,-108.28 11.13,-107.35 9.31,-106.41 7.78,-105.47 6.56,-104.53 5.66,-103.59 5.09,-102.65 4.87,-101.72 5.01,-100.8 5.5,-99.89 6.37,-98.99 7.62,-98.11 9.24,-97.25 11.25,-96.41 13.64,-95.59 16.42,-94.8 19.57,-94.04 23.1,-93.31 26.99,-92.61 31.23,-91.94 35.82,-91.31 40.74,-90.71 45.98,-90.16 51.51,-89.65 57.32,-89.18 63.38,-88.75 69.69,-88.36 76.2,-88.03 82.9,-87.74 89.75,-87.49 96.74,-87.3 103.83,-87.15 111,-87.05 118.21,-87 125.43,-87 132.64,-87.05"/>
<text text-anchor="middle" x="121.82" y="-101.3" font-family="Times,serif" font-size="14.00">https://example.org/foo.csv</text>
</g>
<!-- A&#45;&gt;B -->
<g id="edge1" class="edge">
<title>A&#45;&gt;B</title>
<path fill="none" stroke="black" d="M121.82,-173.8C121.82,-162.16 121.82,-146.55 121.82,-133.24"/>
<polygon fill="black" stroke="black" points="125.32,-133.18 121.82,-123.18 118.32,-133.18 125.32,-133.18"/>
<text text-anchor="middle" x="146.32" y="-144.8" font-family="Times,serif" font-size="14.00">alternate</text>
</g>
<!-- text/csv -->
<g id="node3" class="node">
<title>text/csv</title>
<polygon fill="none" stroke="black" points="151.82,-36 91.82,-36 91.82,0 151.82,0 151.82,-36"/>
<text text-anchor="middle" x="121.82" y="-14.3" font-family="Times,serif" font-size="14.00">text/csv</text>
</g>
<!-- B&#45;&gt;text/csv -->
<g id="edge2" class="edge">
<title>B&#45;&gt;text/csv</title>
<path fill="none" stroke="black" d="M121.82,-86.8C121.82,-75.16 121.82,-59.55 121.82,-46.24"/>
<polygon fill="black" stroke="black" points="125.32,-46.18 121.82,-36.18 118.32,-46.18 125.32,-46.18"/>
<text text-anchor="middle" x="134.32" y="-57.8" font-family="Times,serif" font-size="14.00">type</text>
</g>
</g>
</svg>
</div>

This model can be expressed in many ways: HTML, Atom, Turtle, etc. The RFC8288 defines how to express links using the HTTP `Link` header.

## The header syntax

At first, the syntax seems straightforward but bit by bit we'll see how it gets more knitted. Let's start with a basic example:

```rfc8288
<https://example.org/foo.csv>; rel="alternate"; type="text/csv"
```

It can be expressed in ABNF as:

```abnf
header = link *(OWS "," OWS link)
link   = "<" target ">" *(OWS ";" OWS param)
param  = name ["=" value]
target = uriref
name   = token
value  = token / quoted-string
```

The above, although not complete, already expresses a few rules that are not obvious with the initial example:

- Whitespace (OWS) is optional in many cases.
- A param may not have a value.
- A value may or may not be quoted. 
For example, this is equivalent to the first example:

```rfc8288
<https://example.org/foo.csv>;rel=alternate;type="text/csv"
```

Another example with multiple links:

```rfc8288
<https://example.org/foo.csv>; rel="alternate"; type="text/csv",
<https://example.org/>; rel=canonical,
<http://other.net>; private; anchor="#foo"
```

Let's twist it a bit; when the param name ends in `*` the value should follow the [IETF RFC8187](https://tools.ietf.org/html/rfc8187), for example `UTF-8'en'An%20example`. With that in mind we can extend the original ABNF as:

```abnf
header    = link *(OWS "," OWS link)
link      = "<" target ">" *(OWS ";" OWS (ext-param / param))
param     = name ["=" value]
target    = uriref
name      = token
value     = token / quoted-string
ext-param = name "*" "=" ext-value
ext-value = encoding "'" [language] "'" pct-value
```

## The semantics

Once we have extracted the primitive values from the `Link` header, we need to process them to obtain the list of actual links.

### The context

The **context** is the resource where the header comes from. Its identifier is the request URL. For example, the following HTTP request makes `https://example.net/things` the context for all links found in the response header.

```http
GET /things HTTP/1.1
Host: example.net
Accept: application/json
```

```http
HTTP/1.1 200 OK
Content-Type: application/json
Link: </things?p=2>; rel="next"
```

Things couldn't be that straightforward; if a link has a param `anchor`, the context will change. The `anchor` value must be a valid URI, either absolute or relative.

If it's absolute, it replaces the context entirely. For example:

```http
GET /things HTTP/1.1
Host: example.net
Accept: application/json
```

```http
HTTP/1.1 200 OK
Content-Type: application/json
Link: </>; rel="canonical"; anchor="https://other.org"
```

Makes `https://other.org` the context for that link.

If it is relative, the rules for joining URI's apply. For example:

```http
GET /things HTTP/1.1
Host: example.net
Accept: application/json
```

```http
HTTP/1.1 200 OK
Content-Type: application/json
Link: </copyright>; rel="copyright"; anchor="#section_3"
```

Makes `https://example.net/things#section_3` the context for that link.

Any `anchor` param other than the first one must be ignored.

Finally, the RFC says:

> Note that depending on HTTP status code and response headers, the link context might be "anonymous" (i.e., no link context is available).  For example, this is the case on a 404 response to a GET request.


The rules and reasoning for that escape my understanding.

### The target

The **target** is identified by the URI resulting of joining the URI reference found in `target` (see ABNF rules) with the **context**.

For example, the following HTTP request makes `https://example.net/things?p=2` the link target.

```http
GET /things HTTP/1.1
Host: example.net
Accept: application/json
```

```http
HTTP/1.1 200 OK
Content-Type: application/json
Link: </things?p=2>; rel="next"
```

### The relation type

The `rel` param defines the **relation type** of a link. Any `rel` param other than the first one must be ignored.

The RFC requires a link to have a relation type but the syntax is lax enough to allow for a link to not have one. That makes it somewhat compatible with HTML which does not require links to have any relation type.

For example, the following link defines `https://example.net/` as the canonical resource for the context.

```rfc8288
<https://example.net/>; rel="canonical"
```

You can express multiple relation types at once by separating the types with spaces. For example, the following are equivalent:

```rfc8288
<https://example.org/things>; rel="first previous"
```

```rfc8288
<https://example.org/things>; rel="first", <https://example.org/things>; rel="previous"
```

Previous versions of this RFC define a `rev` param to define a reverse relation type. RFC8288 deprecates it.

### The target title

The `title` param defines the **target title** attribute. Any `title` param other than the first one must be ignored. For example:

```rfc8288
</spoons/>; rel="chapter"; title="Spoons, spoons and some more spoons"
```

Now, HTTP headers are not supposed to have characters other than a subset of the US-ASCII encoding so `title` values are quite limited. The way to escape from this limitation is using the `title*` param. It expects its value to follow the [IETF RFC8187](https://tools.ietf.org/html/rfc8187). In short, it encodes three values in one: encoding, language and the title encoded with [percent-encoding](https://tools.ietf.org/html/rfc3986#section-2.1).

The syntax looks like:

```abnf
ext-value = encoding "'" [language] "'" pct-value
```

Where `encoding` is `UTF-8`, the optional `language` is a valid [IETF RFC5646](https://tools.ietf.org/html/rfc5646) language tag and the percent encoded value uses valid UTF-8 codepoints. The encoding could be something different but as far as I can tell only UTF-8 is normative.

The following link defines both `title` and `title*`. As per the RFC, `title*` takes precedence as long as it can be decoded, otherwise it falls back to `title`.

```rfc8288
</spoons/>; rel="chapter"; title="Spoons"; title*=UTF-8'en'Spoons%20%F0%9F%A5%84
```

So the title of the link above is “Spoons 🥄” but falls back to “Spoons” if the processor can't handle UTF-8 correctly.

### The target content type

The `type` param hints the **target content type** attribute. Any `type` param other than the first one must be ignored.

The value is expected to conform to the [IETF RFC6838](https://tools.ietf.org/html/rfc6838#section-4.2) media type.

```rfc8288
</spoons/>; rel="chapter"; type="text/html"
```

### The target language

The `hreflang` param hints the **target language** attribute. Multiple `hreflang` param hint that the target resource is available in these languages.

The value is expected to conform to the [IETF RFC5646](https://tools.ietf.org/html/rfc5646) language tag.

```rfc8288
</spoons/>; rel="chapter"; hreflang="de"; hreflang="en"
```

### The target medium

The `media` param hints the **target medium** attribute. Any `media` param other than the first one must be ignored.

The value is expected to conform to the [W3C media queries](https://www.w3.org/TR/mediaqueries-4/).

```rfc8288
</spoons/>; rel="chapter"; media="screen and (color)"
```

### Other target attributes

Any other param is considered be a target attribute with unknown semantics. It is suggested that the star rule applied to `title` and `title*` is applied to other pairs (e.g. `author` and `author*`).

## Why would I want to use a link header instead of “x”?

Links can be defined in many ways depending on the capabilities of the serialisation format. For example, [HTML](https://www.w3.org/TR/html5/) has a well defined way via `link`, `a` and `area`; [HAL](http://stateless.co/hal_specification.html) has the `_links` property; [JSON-LD](https://json-ld.org/) builds on top of RDF; etc.

But not all serialisation formats have the same expressivity. For example, CSV is a rigid tabular format with no margin for contextual information. In this case, expressing links via a HTTP header is an interesting possibility. [CSV on the Web](https://www.w3.org/TR/tabular-data-primer/) uses it to link to the metadata with a `rel="describedby"`.

## Resources

- [IETF RFC2046](https://tools.ietf.org/html/rfc2046). Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types.
- [IETF RFC3986](https://tools.ietf.org/html/rfc3986). Uniform Resource Identifier (URI): Generic Syntax.
- [IETF RFC5646](https://tools.ietf.org/html/rfc5646). Tags for Identifying Languages.
- [IETF RFC6838](https://tools.ietf.org/html/rfc6838). Media Type Specifications and Registration Procedures.
- [IETF RFC8187](https://tools.ietf.org/html/rfc8187). Indicating Character Encoding and Language for HTTP Header Field Parameters.
- [IETF RFC8288](https://tools.ietf.org/html/rfc8288). Web linking.
- [IANA relation type registry](https://www.iana.org/assignments/link-relations/link-relations.xhtml).
- [W3C RDF 1.1](https://www.w3.org/TR/rdf11-concepts/). 